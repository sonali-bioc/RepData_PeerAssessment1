{
    "contents" : "# Reproducible Research: Peer Assessment 1\n\nThis markdown file contains code and answers for \"Reproducible Research\"\npeer assesmnet - 1. For deatiled intrsuctions, please look at instructions.pdf\nlying in the \"doc\" folder.\n\n## Loading and preprocessing the data\n\n1. load the data\n```{r}\nrm(list=ls())\n\n#loading the data\ndata <- read.csv(unz(description=file.path(getwd(),\"activity.zip\"),\n                        filename=\"activity.csv\"), header=TRUE,sep=\",\")\n\n```\n\n2. Pre-processing the data\n\n```{r}\ncompletedata <- data[complete.cases(data),]\nnadata <- data[!complete.cases(data),]\n```\n\n## What is mean total number of steps taken per day?\n\n1. Make a histogram of the total number of steps taken each day\n2. Calculate and report the mean and median total number of steps taken per day\n\nFor This part of the assignment we will work only with data which have no NAs.\nWe then work out the total number of steps for each day, create the histogram of\nthat set and calculate the mean and median.\nSince this functionality will be used later - we create a function.\n\n```{r}\ncalculate_histo_mean_meadian <- \n    function(df)\n{\n    sp <- split(df,as.factor(df$date))\n    sapply(sp, function(x){\n        sum(x$steps)\n    })\n    \n}\n\nestimate1 <- calculate_histo_mean_meadian(completedata)\nhist(estimate1, xlab=\"Total no of steps taken each day\",col=\"blue\")\nmean1 = mean(estimate1)\nmedian1 = median(estimate1)\n```\n\n## What is the average daily activity pattern?\n\n\n1. Make a time series plot (i.e. type = \"l\") of the 5-minute interval (x-axis) \nand the average number of steps taken, averaged across all days (y-axis)\n\n```{r}\nsp2<- split(data,as.factor(data$interval))\navgsteps <- sapply(sp2, function(x){\n    mean(x$steps,na.rm=TRUE)\n})\navgstepsdf<- data.frame(interval=names(avgsteps), avgsteps=avgsteps)\n\nplot(names(avgsteps),avgsteps,type=\"l\",xlab=\"5 minute interval\",\n     ylab=\"average no of steps averaged across all days\", col=\"blue\")\n\n```\n\n2. Which 5-minute interval, on average across all the days in the dataset, \ncontains the maximum number of steps?\n\n```{r}\nidx <- names(avgsteps[which(avgsteps==max(avgsteps))])\nidx\n```\n\nThe `r idx `, is the 5-minute interval, on average across all the days in the \ndataset, that contains the maximum number of steps\n\n## Imputing missing values\n\n1. Calculate and report the total number of missing values in the dataset \nWe already calculated data with NA values in the pre-processing step. \n\nThus, the total number of rows with NAs is `r nrow(nadata)`\n\n2. Devise a strategy for filling in all of the missing values in the dataset. \n\nThe  following strategy was used to fill all of the missing values in the \ndataset- We used the mean for that 5-minute interval\n\nSince all the NA's are in the steps column , we can replace it with means for\nthe corresponding 5-minute interval using the following code:\n```{r}\nnadata$steps <- apply(nadata, 1, function(x){\n    int <- as.numeric(x[\"interval\"])\n    avgstepsdf[match(int,avgstepsdf$interval),\"avgsteps\"]\n})\n```\n3. create a new dataset with filled in values. \n```{r}\nfilleddata <- rbind(completedata, nadata)\n```\n\n4. Make a histogram of the total number of steps taken each day ,Calculate and \nreport the mean and median total number of steps taken per day.\n\n```{r}\nestimate2 <- calculate_histo_mean_meadian(filleddata)\nhist(estimate2, xlab=\"Total no of steps taken each day\",col=\"blue\")\nmean2 = mean(estimate2)\nmedian2 = median(estimate2)\n```\n\n5. difference between estimates. \n\nYes, there is a difference between estinates taken at different points:\n\n```{r}\n\nplot(density(estimate2),col=\"red\", xlab=\"Total no of steps taken each day\",\n      ylab=\"Frequency\", main =\"Comaprison of data without NA and data with\n      NA vlaues filled up\")\nlines(density(estimate1),col=\"blue\")\nlegend(\"topright\",legend=c(\"w/o NA values\",\"filled values\"), \n       lty=1, col=c(\"red\",\"blue\"), bty=\"n\")\n```\n\ndata with complete cases had median `r median(estimate1)`\nand mean `r mean(estimate1)`\n\ndata with filled up NA values had median `r median(estimate2)`\nand mean `r mean(estimate2)`\n\n\n## Are there differences in activity patterns between weekdays and weekends?\n\nthe variable weekst is coded 1 for weekdays and 0 for weekends. \n```{r}\n## find the weekday\n \nfilleddata$day <- weekdays(as.Date(filleddata$date))\nfilleddata$weekst <- sapply(filleddata$day, function(x){\n    ifelse(x==\"Saturday\"|x==\"Sunday\",0,1)\n})  \nspweek <- split(filleddata,as.factor(filleddata$weekst))\n\nsp2<- split(spweek[[1]],as.factor(spweek[[1]]$interval))\nweekend<-     sapply(sp2, function(x){\n          mean(x$steps,na.rm=TRUE)\n    })\n\nsp3<- split(spweek[[2]],as.factor(spweek[[2]]$interval))\nweekday <-    sapply(sp3, function(x){\n          mean(x$steps,na.rm=TRUE)\n    })\n\npar(mfrow=c(2,1))\nplot(names(weekend),weekend,type=\"l\",xlab=\"5 minute interval\",\n     ylab=\"average no of steps averaged across weekend\", col=\"blue\")\nplot(names(weekday),weekday,type=\"l\",xlab=\"5 minute interval\",\n     ylab=\"average no of steps averaged weekdays\", col=\"blue\")\n\n```\n",
    "created" : 1400282997559.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3354429552",
    "id" : "5D44B622",
    "lastKnownWriteTime" : 1400455481,
    "path" : "~/GitHub/RepData_PeerAssessment1/PA1_template.Rmd",
    "project_path" : "PA1_template.Rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}